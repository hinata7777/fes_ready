<div class="min-h-screen px-4 pb-24 pt-6">
  <div class="mx-auto flex max-w-6xl flex-col gap-6">
    <%= render Shared::TimetableHeaderComponent.new(
                 title: "マイタイムテーブル作成",
                 festival_name: @festival.name,
                 selected_day: @selected_day,
                 timezone: @timezone
               ) do %>
      <p class="mt-4 text-sm text-slate-700">
        見たいアーティストのブロックをタップして選択してください。選択した内容は「保存する」を押すとマイタイムテーブルに反映されます。
      </p>
    <% end %>

    <%= form_with url: my_timetable_festival_path(@festival, date: @selected_day.date.to_s, user_id: current_user.uuid),
                  method: :post,
                  class: "flex flex-col gap-6" do %>
      <% stage_renderer = ->(stage) do
           render StageColumns::PickerComponent.new(
             stage: stage,
             performances: @performances_by_stage[stage.id],
             time_markers: @time_markers,
             timeline_layout: @timeline_layout,
             picked_ids: @picked_ids
           )
         end %>

      <%= render Shared::TimetableBoardComponent.new(
               stages: @stages,
               time_markers: @time_markers,
               timeline_layout: @timeline_layout,
               timezone: @timezone,
               empty_message: "登録されたステージがありません",
               stage_renderer: stage_renderer
             ) %>

      <div class="flex justify-center">
        <%= submit_tag "保存する",
                       class: "inline-flex items-center justify-center rounded-2xl bg-indigo-500 px-6 py-3 text-sm font-bold text-white shadow-md interactive-lift hover:bg-indigo-400 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500" %>
      </div>
    <% end %>
  </div>
</div>
