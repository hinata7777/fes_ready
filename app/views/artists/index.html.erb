<div class="min-h-screen px-4 pb-24 pt-6">
  <div class="mx-auto max-w-6xl space-y-6">
    <header class="space-y-4">
      <h1 class="text-2xl font-bold text-slate-900">
        <%= @festival ? "#{@festival.name} の出演アーティスト" : "アーティスト一覧" %>
      </h1>

      <% if @festival.present? && @festival_days.any? %>
        <% preserved_query = request.query_parameters.except(:page, :festival_day_id) %>
        <div class="flex justify-center">
          <div class="inline-flex rounded-xl bg-white p-1 shadow-md">
            <% @festival_days.each do |festival_day| %>
              <% active = @selected_festival_day&.id == festival_day.id %>
              <% link_classes = [
                "rounded-lg px-4 py-2 text-sm font-semibold transition",
                active ? "bg-rose-500 text-white shadow-sm" : "text-slate-500 hover:text-rose-500"
              ].join(" ") %>
              <%= link_to format_date_with_weekday(festival_day.date),
                          festival_artists_path(@festival, preserved_query.merge(festival_day_id: festival_day.id)),
                          class: link_classes %>
            <% end %>
          </div>
        </div>
      <% end %>

      <% if @festival.present? && @selected_festival_day %>
        <p class="text-sm font-semibold text-slate-600">
          <%= format_date_with_weekday(@selected_festival_day.date) %> の出演アーティスト
        </p>
      <% end %>
    </header>

    <% search_url = if @festival.present?
      festival_artists_path(@festival, festival_day_id: @selected_festival_day&.id)
    else
      artists_path
    end %>

    <%= render "shared/search_form",
               query: @q,
               url: search_url,
               hidden_fields: (@selected_festival_day ? { festival_day_id: @selected_festival_day.id } : {}),
               placeholder: "アーティスト名を入力" %>

    <section>
      <% if @artists.any? %>
        <div class="grid grid-cols-2 gap-4 md:grid-cols-3 lg:grid-cols-4">
          <% @artists.each do |artist| %>
            <%= render "shared/artist_card", artist: artist %>
          <% end %>
        </div>
      <% else %>
        <p class="rounded-3xl border border-dashed border-slate-300 bg-white px-6 py-16 text-center text-sm text-slate-500">
          表示できるアーティストがありません
        </p>
      <% end %>
    </section>
  </div>
  <%= render "shared/pagination", pagy: @pagy %>
</div>
