<div class="min-h-screen px-4 pb-24 pt-6">
  <div class="mx-auto max-w-3xl space-y-6">
    <header class="space-y-2">
      <h1 class="text-2xl font-bold text-slate-900">持ち物リスト詳細</h1>
      <p class="text-lg font-bold text-slate-900"><%= @packing_list.title %></p>
      <% if @packing_list.festival_day.present? %>
        <% day = @packing_list.festival_day %>
        <div class="inline-flex items-center gap-2 rounded-full bg-slate-100 px-3 py-1 text-xs font-semibold text-slate-700">
          <span><%= day.festival.name %></span>
          <span class="text-slate-500">/</span>
          <span><%= format_date_with_weekday(day.date) %></span>
        </div>
      <% else %>
        <div class="inline-flex items-center gap-2 rounded-full bg-slate-100 px-3 py-1 text-xs font-semibold text-slate-700">
          <span>日程未設定</span>
          <span class="text-slate-500">/</span>
          <span>日程を設定すると天気を表示します</span>
        </div>
      <% end %>
    </header>

    <% owned_list = (@packing_list.user == current_user) %>

    <% if @festival_weather_forecast.present? %>
      <%= render "packing_lists/festival_weather", forecast: @festival_weather_forecast %>
    <% elsif @packing_list.festival_day.present? %>
      <div class="rounded-2xl border border-dashed border-slate-300 bg-slate-50 px-4 py-3 text-sm text-slate-700">
        開催日の約2週間前から天気予報を表示します。
      </div>
    <% end %>

    <section class="rounded-3xl border border-slate-200 bg-white px-5 py-4 shadow-sm">
      <h2 class="sr-only">持ち物一覧</h2>
      <% if @packing_list_items.any? %>
        <ul class="space-y-3">
          <% @packing_list_items.each do |pli| %>
            <%= render "packing_lists/item", packing_list: @packing_list, pli: pli, owned_list: owned_list %>
          <% end %>
        </ul>
      <% else %>
        <div class="rounded-2xl border border-dashed border-slate-300 bg-slate-50 px-4 py-8 text-center text-sm text-slate-600">
          まだ持ち物がありません。「編集」から持ち物を追加してください。
        </div>
      <% end %>
    </section>

    <div class="flex flex-wrap items-center justify-center gap-3">
      <% if owned_list %>
        <%= link_to "編集",
                    edit_packing_list_path(@packing_list),
                    class: "inline-flex min-w-[8rem] items-center justify-center rounded-2xl bg-indigo-500 px-5 py-2.5 text-sm font-bold text-white shadow-md interactive-lift hover:bg-indigo-400 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500",
                    data: { controller: "tap-feedback" } %>
        <%= button_to "削除",
                      packing_list_path(@packing_list),
                      method: :delete,
                      data: { controller: "tap-feedback", turbo_confirm: "この持ち物リストを削除しますか？" },
                      class: "inline-flex min-w-[8rem] items-center justify-center rounded-2xl bg-rose-500 px-5 py-2.5 text-sm font-bold text-white shadow-md interactive-lift hover:bg-rose-400 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-rose-500" %>
      <% end %>
    </div>

    <div class="mt-12 sm:mt-16">
      <%= render "packing_lists/affiliate_links" %>
    </div>
  </div>
</div>
