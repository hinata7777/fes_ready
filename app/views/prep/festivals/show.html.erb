<div class="min-h-screen px-4 py-6">
  <div class="mx-auto max-w-5xl space-y-6">
    <header class="space-y-3">
      <p class="text-sm font-semibold text-rose-500">フェス予習</p>
      <h1 class="text-2xl font-bold text-slate-900"><%= @festival.name %></h1>
      <p class="text-sm text-slate-600"><%= festival_date_and_location(@festival) %></p>
    </header>

    <% day_tabs = festival_day_tabs(@festival_days) %>
    <div class="flex justify-center">
      <%= render "shared/segmented_tabs",
            tabs: day_tabs[:tabs],
            active_tab_key: @selected_day.id,
            url_builder: ->(festival_day_id) do
              day = day_tabs[:lookup][festival_day_id]
              prep_festival_path(@festival, date: day.date.to_s, back_to: params[:back_to])
            end %>
    </div>

    <section class="space-y-4">
      <h2 class="text-lg font-semibold text-slate-900">
        <%= @selected_day.date.strftime("%-m/%-d") %> 出演アーティストの予習曲
      </h2>
      <p class="text-sm text-slate-600">各アーティストの演奏率が高い上位2曲を表示しています。<br>出演日のアーティストを広く予習したい場合のオススメ曲です。</p>

      <% if @song_entries.any? %>
        <div class="grid gap-3 md:grid-cols-2">
          <% @song_entries.each do |entry| %>
            <div class="space-y-2 rounded-2xl bg-white p-4 shadow-sm ring-1 ring-slate-200">
              <p class="text-sm font-semibold text-slate-900">
                <%= entry[:song].name %> / <%= entry[:artist].name %>
              </p>
              <div class="overflow-hidden rounded-xl border border-slate-200 shadow-sm">
                <%= spotify_embed_block(entry[:song]) %>
              </div>
            </div>
          <% end %>
        </div>
        <%= render "shared/pagination", pagy: @pagy %>
      <% else %>
        <div class="rounded-2xl bg-white px-4 py-12 text-center text-sm text-slate-600 shadow space-y-1">
          <span class="block">表示できるアーティストがいません。</span>
          <span class="block">セットリストが十分に集まっていない、出演アーティストが未定の可能性があります。</span>
          <span class="block">日程を切り替えるか、後日もう一度確認してください。</span>
        </div>
      <% end %>
    </section>
  </div>
</div>
