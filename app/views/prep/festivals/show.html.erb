<div class="min-h-screen px-4 py-6">
  <div class="mx-auto max-w-5xl space-y-6">
    <header class="space-y-3">
      <p class="text-sm font-semibold text-rose-500">フェス予習</p>
      <h1 class="text-2xl font-bold text-slate-900"><%= @festival.name %></h1>
      <p class="text-sm text-slate-600"><%= festival_date_and_location(@festival) %></p>
    </header>

    <% day_lookup = @festival_days.index_by(&:id) %>
    <% tab_items = day_lookup.transform_values { |day| day.date.strftime("%-m/%-d") } %>
    <div class="flex justify-center">
      <%= render Shared::SegmentedTabsComponent.new(
            tabs: tab_items,
            active_tab_key: @selected_day.id,
            url_builder: ->(festival_day_id) do
              day = day_lookup[festival_day_id]
              prep_festival_path(@festival, date: day.date.to_s)
            end
          ) %>
    </div>

    <section class="space-y-4">
      <h2 class="text-lg font-semibold text-slate-900">
        <%= @selected_day.date.strftime("%-m/%-d") %> 出演アーティストの予習曲
      </h2>

      <% if @song_entries.any? %>
        <div class="grid gap-3 md:grid-cols-2">
          <% @song_entries.each do |entry| %>
            <div class="space-y-2 rounded-2xl bg-white p-4 shadow-sm ring-1 ring-slate-200">
              <p class="text-sm font-semibold text-slate-900">
                <%= entry[:song].name %> / <%= entry[:artist].name %>
              </p>
              <% embed = spotify_embed_for(entry[:song]) %>
              <% if embed.present? %>
                <div class="overflow-hidden rounded-xl border border-slate-200 shadow-sm">
                  <%= embed %>
                </div>
              <% else %>
                <p class="text-xs text-slate-500">Spotify未登録の曲です</p>
              <% end %>
            </div>
          <% end %>
        </div>
        <%= render "shared/pagination", pagy: @pagy %>
      <% else %>
        <div class="rounded-2xl bg-white px-4 py-12 text-center text-sm text-slate-600 shadow">
          表示できるアーティストがいません
        </div>
      <% end %>
    </section>
  </div>
</div>
