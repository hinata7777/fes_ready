<div class="min-h-screen px-4 py-6">
  <div class="mx-auto max-w-5xl space-y-6">
    <header class="space-y-4">
      <h1 class="text-2xl font-bold text-slate-900">タイムテーブルを見たいフェスを選択</h1>
      <% unless user_signed_in? %>
        <%= render "shared/login_callout",
                   title: "ログインしてマイタイムテーブルを作成しましょう",
                   description: "お気に入りのステージや出演枠を選んで、自分専用のタイムテーブルを作成できます。",
                   cta_label: "ログイン" %>
      <% end %>
      <div class="flex flex-col gap-3 text-sm text-slate-600 sm:flex-row sm:items-center sm:justify-between">
        <p>公開中のタイムテーブルのみ表示しています。</p>
        <% if user_signed_in? %>
          <%= link_to "マイタイムテーブル一覧へ",
                      my_timetables_path,
                      class: "inline-flex items-center justify-center rounded-2xl bg-indigo-500 px-4 py-2 text-sm font-semibold text-white shadow-md interactive-lift hover:bg-indigo-400 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500",
                      data: { controller: "tap-feedback" } %>
        <% end %>
      </div>
      <% preserved_query = request.query_parameters.except(:page, :status) %>
      <div class="flex justify-center">
        <%= render Shared::SegmentedTabsComponent.new(
              tabs: @status_labels,
              active_tab_key: @status,
              url_builder: ->(key) { timetables_path(preserved_query.merge(status: key)) }
            ) %>
      </div>
    </header>

    <%= render Shared::SearchFormComponent.new(
               query: @q,
               url: timetables_path,
               placeholder: "フェス名を入力",
               status: @status
             ) %>

    <section class="grid gap-3 md:grid-cols-2 md:gap-4">
      <% if @festivals.any? %>
        <% @festivals.each do |festival| %>
          <div class="w-full">
            <%= render "shared/nav_stack_button",
                       label: festival.name,
                       url: timetable_path(festival, from: "timetables") %>
          </div>
        <% end %>
      <% else %>
        <p class="rounded-xl bg-white px-4 py-12 text-center text-sm text-slate-500 shadow md:col-span-2">
          公開中のタイムテーブルはありません
        </p>
      <% end %>
    </section>
  </div>
  <%= render "shared/pagination", pagy: @pagy %>
</div>
