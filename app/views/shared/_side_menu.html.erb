<% is_signed_in = defined?(user_signed_in?) && user_signed_in? %>
<% primary_links = is_signed_in ? [
  { label: "マイページ", href: mypage_dashboard_path },
  { label: "ログアウト", href: destroy_user_session_path, method: :delete }
] : [
  { label: "ログイン", href: new_user_session_path }
] %>
<% secondary_links = [
  { label: "利用規約", href: terms_path },
  { label: "プライバシーポリシー", href: privacy_path },
  { label: "お問い合わせ", href: "https://forms.gle/N9j4cZw7xPhbsHZE8", external: true }
] %>

<div
  class="fixed inset-0 z-40 hidden bg-black/60 opacity-0 transition-opacity duration-300"
  data-side-menu-target="backdrop"
  data-action="click->side-menu#close"
></div>

<aside
  id="app-side-menu"
  class="fixed inset-y-0 right-0 z-50 flex w-64 max-w-[80vw] translate-x-full flex-col justify-between bg-black/80 px-8 py-12 text-white shadow-xl transition-transform duration-300 ease-out"
  data-side-menu-target="panel"
>
  <nav class="space-y-6 text-lg">
    <% primary_links.each do |link| %>
      <% if link[:method] == :delete %>
        <%= button_to link[:label], link[:href],
              method: :delete,
              class: "block w-full text-left font-medium tracking-wide text-white transition hover:opacity-80",
              data: { turbo_confirm: "ログアウトしますか？" } %>
      <% else %>
        <%= link_to link[:label], link[:href],
              class: "block font-medium tracking-wide text-white transition hover:opacity-80",
              data: { action: "side-menu#close" } %>
      <% end %>
    <% end %>
  </nav>

  <nav class="space-y-3 text-sm">
    <% secondary_links.each do |link| %>
      <%= link_to link[:href],
            class: "block tracking-wide text-white/90 transition hover:text-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-white",
            data: { action: "side-menu#close" },
            target: (link[:external] ? "_blank" : nil),
            rel: (link[:external] ? "noopener" : nil) do %>
        <%= link[:label] %>
      <% end %>
    <% end %>
  </nav>
</aside>
