<section class="rounded-3xl border border-slate-200 bg-gradient-to-b from-slate-100 via-white to-slate-100 p-3 shadow-lg shadow-slate-200/60 sm:p-4">
  <div class="overflow-x-auto overflow-y-hidden">
    <div class="flex items-start gap-2 md:gap-3">
      <div class="sticky left-0 z-10 flex flex-shrink-0 flex-col items-center bg-white/90 backdrop-blur-sm shadow-sm">
        <div class="h-10 w-14 sm:h-12 sm:w-16"></div>
        <div class="relative w-14 rounded-xl border border-slate-200 bg-white/80 text-[10px] font-semibold text-slate-600 sm:w-16 sm:text-[11px]" style="<%= marker_timeline_style %>">
          <% marker_lines.each do |line| %>
            <div class="absolute inset-x-0 border-t border-slate-200/70" style="top: <%= line.top_percent %>%;"></div>
          <% end %>

          <% marker_labels.each do |label| %>
            <div class="<%= [ "absolute inset-x-0 text-center pointer-events-none", label.css_translation_class ].join(" ") %>" style="top: <%= label.top_percent %>%;"><span class="inline-block rounded bg-white/90 px-[3px] py-0.5 font-mono text-[9px] text-slate-700 shadow-sm sm:px-1 sm:text-[10px]"><%= label.label_text %></span></div>
          <% end %>
        </div>
      </div>

      <div class="flex flex-1 gap-2 md:gap-3">
        <% if stages.any? %>
          <% stages.each do |stage| %>
            <%= stage_renderer.call(stage) %>
          <% end %>
        <% else %>
          <div class="flex h-full min-h-[320px] flex-1 items-center justify-center rounded-2xl border border-dashed border-slate-300 bg-white/70 px-6 py-12 text-center text-sm text-slate-500"><%= empty_message %></div>
        <% end %>
      </div>
    </div>
  </div>
</section>
